import{G as p}from"./index-CqdEBXbW.js";class i{constructor(s,r,o){this.message=s,this.status=r,this.data=o}}const g={500:"Ошибка сервера. Пожалуйста, попробуйте позже или обратитесь в службу заботы",422:"Ошибка обработки данных. Пожалуйста, обратитесь в службу заботы",408:"Время ожидания истекло. Пожалуйста, попробуйте повторить позже"},h=async({METHOD:t,RESOURCE:s,ERRORS:r,BODY:o,ADAPTER:c})=>{const u=new URL(s),l={method:t,headers:{"Content-type":"application/json; charset=UTF-8",accept:"application/json"}};t==="GET"&&o&&Object.entries(o).forEach(([e,a])=>{a!=null&&u.searchParams.append(e,a)}),t==="POST"&&(l.body=JSON.stringify(o));try{const e=await fetch(u,l);console.log(e);const a=e.status;let n=await e.json();if(a>=200&&a<=300)return c&&(n=c(n)),{status:a,data:n};throw new i(r[e.status]||g[e.status]||n.detail||"Неизвестная ошибка",a,n)}catch(e){throw e instanceof i?{message:e.message,status:e.status||500,data:e.data}:(console.log(e),{message:"Сервисная ошибка"})}},f={500:"Server error. Please try again later or contact the support",422:"Data processing error. Please contact the Care Service.",408:"The timeout has expired. Please try again later"},d=({STATUS:t,ERRORS:s,BODY:r})=>new Promise((o,c)=>{t!==200?c(new i(s[t]||f[t]||"Unknown bug",t,s)):o({status:t,data:r})}),w={post(t){return h({METHOD:"POST",...t})},get(t){return h({METHOD:"GET",...t})},async test(t){const s=d(t);try{const r=await s;console.log(r)}catch(r){console.log(r)}return s}},y={checkDevice(t){return w.post({RESOURCE:p,ERRORS:{},BODY:t})}};export{w as R,y as S};
